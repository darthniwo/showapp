{"version":3,"sources":["controllers/loginCtrl.js"],"names":["angular","module","controller","loginCtrl","$scope","$state","alertify","commonSrv","sessionSrv","obj","common","session","init","isLoading","getUser","valid","msg","$broadcast","loginForm","$invalid","error","form_data","login","user","password","pass","domain","actual_domain","then","loginStatus","setUserData","setHeaders","token","go"],"mappings":"AAAA;;AACA,CAAC,UAASA,OAAT,EAAiB;AAChBA,UACGC,MADH,CACU,KADV,EAEGC,UAFH,CAEc,WAFd,EAE2B,CAAC,QAAD,EAAU,QAAV,EAAmB,UAAnB,EAA8B,WAA9B,EAA0C,YAA1C,EAAwDC,SAAxD,CAF3B;;AAIE,WAASA,SAAT,CAAmBC,MAAnB,EAA0BC,MAA1B,EAAiCC,QAAjC,EAA2CC,SAA3C,EAAsDC,UAAtD,EAAiE;AAC/D,UAAMC,MAAM,IAAZ;AAAA,UAAkBC,SAASH,SAA3B;AAAA,UAAsCI,UAAUH,UAAhD;;AAEA,aAASI,IAAT,GAAe;AACbH,UAAII,SAAJ,GAAgB,KAAhB;AAED;;AAEDJ,QAAIK,OAAJ,GAAc,YAAU;AACtB,UAAIC,QAAQ,IAAZ;AAAA,UAAkBC,MAAM,EAAxB;AACAP,UAAII,SAAJ,GAAgB,IAAhB;AACAT,aAAOa,UAAP,CAAkB,4BAAlB;AACA,UAAIR,IAAIS,SAAJ,CAAcC,QAAlB,EAA4B;AAC1BV,YAAII,SAAJ,GAAgB,KAAhB;AACAE,gBAAQ,KAAR;AACAT,iBAASc,KAAT,CAAe,0BAAf;AACA;AACD;;AAED,UAAIC,YAAY;AACdC,eAAOb,IAAIc,IADG;AAEdC,kBAAUf,IAAIgB,IAFA;AAGdC,gBAAQhB,OAAOiB;AAHD,OAAhB;;AAMAhB,cAAQW,KAAR,CAAcD,SAAd,EAAyBO,IAAzB,CAA8B,YAAU;AACtCnB,YAAII,SAAJ,GAAgB,KAAhB;;AAEA,YAAGF,QAAQkB,WAAX,EAAuB;AACrBnB,iBAAOoB,WAAP,CAAmBnB,QAAQY,IAA3B;AACAb,iBAAOqB,UAAP,CAAkBpB,QAAQY,IAAR,CAAaS,KAA/B;AACA3B,iBAAO4B,EAAP,CAAU,cAAV;AACD,SAJD,MAIK;AACH3B,mBAASc,KAAT,CAAe,4DAAf;AACD;AACF,OAVD;AAWD,KA5BD;;AA8BAR;AAED;AAEJ,CA/CD,EA+CGZ,OA/CH","file":"loginCtrl.js","sourcesContent":["'use strict';\n(function(angular){\n  angular\n    .module('sbx')\n    .controller('loginCtrl', ['$scope','$state','alertify','commonSrv','sessionSrv', loginCtrl]);\n\n    function loginCtrl($scope,$state,alertify, commonSrv, sessionSrv){\n      const obj = this, common = commonSrv, session = sessionSrv;\n\n      function init(){\n        obj.isLoading = false;\n       \n      }\n\n      obj.getUser = function(){\n        let valid = true, msg = '';\n        obj.isLoading = true;\n        $scope.$broadcast('show-errors-check-validity');\n        if (obj.loginForm.$invalid) {\n          obj.isLoading = false;\n          valid = false;\n          alertify.error('There are invalid fields');\n          return;\n        }\n\n        let form_data = {\n          login: obj.user,\n          password: obj.pass,\n          domain: common.actual_domain\n        }\n        \n        session.login(form_data).then(function(){\n          obj.isLoading = false;\n          \n          if(session.loginStatus){\n            common.setUserData(session.user);\n            common.setHeaders(session.user.token);\n            $state.go('main.general');\n          }else{\n            alertify.error('Nombre de Usuario o Password incorrecto, intente de nuevo.');\n          }\n        });\n      }\n\n      init();\n\n    }\n\n})(angular);"]}